<page-header title="'创建容器'" breadcrumbs="[{label:'容器', link:'docker.containers'}, '添加容器']"> </page-header>

<information-panel title-text="注意" ng-if="state.mode == 'duplicate'">
  <span class="small">
    <p class="text-muted">
      <pr-icon icon="'alert-triangle'" mode="'warning'" class-name="'mr-0.5'"></pr-icon>
      如果更改了镜像，并且前一个容器的设置与之不兼容，则新容器可能无法启动。常见原因包括镜像设置的入口点、cmd或其他设置。
      <a href="https://docs.portainer.io/user/docker/containers/advanced" target="_blank">更多设置</a>
    </p>
  </span>
</information-panel>

<div class="row">
  <div class="col-lg-12 col-md-12 col-xs-12">
    <rd-widget>
      <rd-widget-body>
        <form class="form-horizontal" autocomplete="off">
          <!-- name-input -->
          <div class="form-group">
            <label for="container_name" class="col-sm-3 col-lg-2 control-label text-left">名称</label>
            <div class="col-sm-8">
              <input type="text" class="form-control" ng-model="config.name" id="container_name" placeholder="例如 myContainer" />
            </div>
          </div>
          <!-- !name-input -->
          <div class="col-sm-12 form-section-title"> 镜像配置 </div>
          <div ng-if="!formValues.RegistryModel.Registry && fromContainer">
            <pr-icon icon="'alert-triangle'" mode="'warning'"></pr-icon>
            <span class="small text-danger" style="margin-left: 5px">
              未在 Portainer 中注册 <code>{{ config.Image }}</code> 镜像的 Docker 注册表，您将无法创建容器。请先注册该注册表。
            </span>
          </div>
          <div ng-if="formValues.RegistryModel.Registry || !fromContainer">
            <!-- image-and-registry -->
            <por-image-registry
              model="formValues.RegistryModel"
              ng-if="formValues.RegistryModel.Registry"
              auto-complete="true"
              endpoint="endpoint"
              is-admin="isAdmin"
              check-rate-limits="formValues.alwaysPull"
              on-image-change="onImageNameChange()"
              set-validity="setPullImageValidity"
            >
              <!-- always-pull -->
              <div class="form-group">
                <div class="col-sm-12">
                  <por-switch-field
                    name="'alwaysPull'"
                    label-class="'col-sm-2'"
                    checked="formValues.alwaysPull"
                    disabled="!state.pullImageValidity"
                    label="'始终拉取镜像'"
                    on-change="(onAlwaysPullChange)"
                    tooltip="'启用时，Portainer 将在创建容器之前自动尝试拉取指定的镜像。'"
                  ></por-switch-field>
                </div>
              </div>
              <!-- !always-pull -->
            </por-image-registry>
            <!-- !image-and-registry -->
          </div>
        
          <!-- create-webhook -->
          <div ng-if="isAdmin && applicationState.endpoint.type !== 4">
            <div class="col-sm-12 form-section-title"> Webhooks </div>
            <div class="form-group">
              <div class="col-sm-12">
                <por-switch-field
                  feature-id="'container-webhook'"
                  label-class="'col-sm-2'"
                  label="'创建容器 Webhook'"
                  tooltip="'创建一个 Webhook（或回调 URI）以自动重新创建此容器。向此回调 URI 发送 POST 请求（无需任何身份验证）将拉取关联镜像的最新版本并重新创建此容器。'"
                ></por-switch-field>
              </div>
            </div>
          </div>
          <!-- !create-webhook  -->
        
          <div class="col-sm-12 form-section-title"> 网络端口配置 </div>
          <!-- publish-exposed-ports -->
          <div class="form-group">
            <div class="col-sm-12">
              <por-switch-field
                label-class="'col-sm-2'"
                checked="config.HostConfig.PublishAllPorts"
                label="'将所有公开的网络端口发布到随机主机端口'"
                on-change="(handlePublishAllPortsChange)"
                tooltip="'启用时，Portainer 将允许 Docker 自动将主机上的随机端口映射到 Dockerfile 中定义的每个端口。'"
              ></por-switch-field>
            </div>
          </div>
          <!-- !publish-exposed-ports -->
          <!-- port-mapping -->
          <div class="form-group">
            <div class="col-sm-12">
              <label class="control-label text-left">
                手动网络端口发布
                <portainer-tooltip
                  message="'在主机上指定端口范围和容器上的单个端口时，Docker 将在定义的范围内随机选择一个可用端口并将其转发到容器端口。'"
                ></portainer-tooltip>
              </label>
              <span class="label label-default interactive" style="margin-left: 10px" ng-click="addPortBinding()">
                <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 发布一个新的网络端口
              </span>
            </div>
            <!-- port-mapping-input-list -->
            <div class="col-sm-12 form-inline" style="margin-top: 10px">
              <div ng-repeat="portBinding in config.HostConfig.PortBindings" style="margin-top: 2px">
                <!-- host-port -->
                <div class="input-group col-sm-4 input-group-sm">
                  <span class="input-group-addon">主机</span>
                  <input type="text" class="form-control" ng-model="portBinding.hostPort" placeholder="例如 80、80-88、ip:80 或 ip:80-88（可选）" />
                </div>
                <!-- !host-port -->
                <span style="margin: 0 10px 0 10px">
                  <pr-icon icon="'arrow-right'"></pr-icon>
                </span>
                <!-- container-port -->
                <div class="input-group col-sm-4 input-group-sm">
                  <span class="input-group-addon">容器</span>
                  <input type="text" class="form-control" ng-model="portBinding.containerPort" placeholder="例如 80 或 80-88" />
                </div>
                <!-- !container-port -->
                <!-- protocol-actions -->
                <div class="input-group col-sm-3 input-group-sm">
                  <div class="btn-group btn-group-sm">
                    <label class="btn btn-light" ng-model="portBinding.protocol" uib-btn-radio="'tcp'">TCP</label>
                    <label class="btn btn-light" ng-model="portBinding.protocol" uib-btn-radio="'udp'">UDP</label>
                  </div>
                  <button class="btn btn-light" type="button" ng-click="removePortBinding($index)">
                    <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                  </button>
                </div>
                <!-- !protocol-actions -->
              </div>
            </div>
            <!-- !port-mapping-input-list -->
          </div>
          <!-- !port-mapping -->
          <div ng-if="applicationState.endpoint.mode.agentProxy && applicationState.endpoint.mode.provider === 'DOCKER_SWARM_MODE'">
            <div class="col-sm-12 form-section-title"> 部署 </div>
            <!-- node-selection -->
            <node-selector model="formValues.NodeName" endpoint-id="endpoint.Id"> </node-selector>
            <!-- !node-selection -->
          </div>
          <!-- access-control -->
          <por-access-control-form form-data="formValues.AccessControlData" resource-control="fromContainer.ResourceControl" ng-if="fromContainer"></por-access-control-form>
          <!-- !access-control -->
          <!-- actions -->
          <div class="col-sm-12 form-section-title"> 操作 </div>
          <!-- autoremove -->
          <div class="form-group">
            <div class="col-sm-12">
              <por-switch-field
                label-class="'col-sm-2'"
                checked="config.HostConfig.AutoRemove"
                label="'自动删除'"
                on-change="(handleAutoRemoveChange)"
                tooltip="'启用时，Portainer 将在容器退出时自动删除容器。当您只想使用容器一次时，这是很有用的。'"
              ></por-switch-field>
            </div>
          </div>
          <!-- !autoremove -->
          <div class="form-group">
            <div class="col-sm-12">
              <button
                type="button"
                class="btn btn-primary btn-sm !ml-0"
                ng-disabled="state.actionInProgress || !formValues.RegistryModel.Image || (!formValues.RegistryModel.Registry && fromContainer)
                           || (fromContainer.IsPortainer && fromContainer.Name === '/' + config.name)"
                ng-click="create()"
                button-spinner="state.actionInProgress"
              >
                <span ng-hide="state.actionInProgress">部署容器</span>
                <span ng-show="state.actionInProgress">部署中...</span>
              </button>
              <span class="text-danger" ng-if="state.formValidationError" style="margin-left: 5px">{{ state.formValidationError }}</span>
            </div>
          </div>
          <!-- !actions -->
        </form>
      </rd-widget-body>
    </rd-widget>
  </div>
</div>

<div class="row">
  <div class="col-lg-12 col-md-12 col-xs-12">
    <rd-widget>
      <rd-widget-header icon="settings" title-text="高级容器设置"></rd-widget-header>
      <rd-widget-body>
        <ul class="nav nav-pills nav-justified">
          <li class="active interactive"><a data-target="#command" data-toggle="tab">命令与日志记录</a></li>
          <li class="interactive"><a data-target="#volumes" data-toggle="tab">存储卷</a></li>
          <li class="interactive"><a data-target="#network" data-toggle="tab">网络</a></li>
          <li class="interactive"><a data-target="#env" data-toggle="tab">环境变量</a></li>
          <li class="interactive"><a data-target="#labels" data-toggle="tab">标签</a></li>
          <li class="interactive"><a data-target="#restart-policy" data-toggle="tab">重启策略</a></li>
          <li class="interactive"><a data-target="#runtime-resources" ng-mouseup="refreshSlider()" data-toggle="tab">运行时与资源</a></li>
          <li ng-if="areContainerCapabilitiesEnabled" class="interactive"><a data-target="#container-capabilities" data-toggle="tab">容器能力</a></li>
        </ul>
        <!-- tab-content -->
        <div class="tab-content">
          <!-- tab-command -->
          <div class="tab-pane active" id="command">
            <form class="form-horizontal" style="margin-top: 15px">
              <!-- command-input -->
              <div class="form-group">
                <label for="container_command" class="col-sm-2 col-lg-1 control-label text-left">命令</label>
                <div class="col-sm-9">
                  <div class="input-group">
                    <div class="input-group-btn">
                      <label class="btn btn-light" ng-model="formValues.CmdMode" uib-btn-radio="'default'" style="margin-left: 0px"> 默认</label>
                      <label class="btn btn-light" ng-model="formValues.CmdMode" uib-btn-radio="'override'">覆盖</label>
                    </div>
                    <input
                      type="text"
                      class="form-control"
                      ng-model="config.Cmd"
                      ng-disabled="formValues.CmdMode === 'default'"
                      id="container_command"
                      placeholder="例如 '-logtostderr' '--housekeeping_interval=5s' 或 /usr/bin/nginx -t -c /mynginx.conf"
                    />
                  </div>
                </div>
              </div>
              <!-- !command-input -->
              <!-- entrypoint-input -->
              <div class="form-group">
                <label for="container_entrypoint" class="col-sm-2 col-lg-1 control-label text-left">
                  入口点
                  <portainer-tooltip
                    message="'当容器入口点作为命令字段的一部分输入时，请将入口点设置为覆盖模式并留空，否则将恢复为默认值。'"
                  ></portainer-tooltip>
                </label>
                <div class="col-sm-9">
                  <div class="input-group">
                    <div class="input-group-btn">
                      <label class="btn btn-light" ng-model="formValues.EntrypointMode" uib-btn-radio="'default'" style="margin-left: 0px"> 默认</label>
                      <label class="btn btn-light" ng-model="formValues.EntrypointMode" uib-btn-radio="'override'">覆盖</label>
                    </div>
                    <input
                      type="text"
                      class="form-control"
                      ng-model="config.Entrypoint"
                      ng-disabled="formValues.EntrypointMode === 'default'"
                      id="container_entrypoint"
                      placeholder="例如 /bin/sh -c"
                    />
                  </div>
                </div>
              </div>
              <!-- !entrypoint-input -->
              <!-- workdir-user-input -->
              <div class="form-group">
                <label for="container_workingdir" class="col-sm-2 col-lg-1 control-label text-left">工作目录</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" ng-model="config.WorkingDir" id="container_workingdir" placeholder="例如 /myapp" />
                </div>
                <label for="container_user" class="col-sm-1 control-label text-left">用户</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" ng-model="config.User" id="container_user" placeholder="例如 nginx" />
                </div>
              </div>
              <!-- !workdir-user-input -->
              <!-- console -->
              <div class="form-group">
                <label for="container_console" class="col-sm-2 col-lg-1 control-label text-left">控制台</label>
                <div class="col-sm-10 col-lg-11">
                  <div class="col-sm-4">
                    <label class="radio-inline">
                      <input type="radio" name="container_console" ng-model="formValues.Console" value="both" />
                      交互式与TTY <span class="small text-muted">(-i -t)</span>
                    </label>
                  </div>
                  <div class="col-sm-4">
                    <label class="radio-inline">
                      <input type="radio" name="container_console" ng-model="formValues.Console" value="interactive" />
                      交互式 <span class="small text-muted">(-i)</span>
                    </label>
                  </div>
                </div>
                <div class="col-sm-offset-2 col-sm-10 col-lg-offset-1 col-lg-11">
                  <div class="col-sm-4">
                    <label class="radio-inline">
                      <input type="radio" name="container_console" ng-model="formValues.Console" value="tty" />
                      TTY <span class="small text-muted">(-t)</span>
                    </label>
                  </div>
                  <div class="col-sm-4">
                    <label class="radio-inline">
                      <input type="radio" name="container_console" ng-model="formValues.Console" value="none" />
                      none
                    </label>
                  </div>
                </div>
              </div>
              <!-- !console -->

              <div class="col-sm-12 form-section-title"> 日志记录 </div>
              <!-- logging-driver -->
              <div class="form-group">
                <label for="log-driver" class="col-sm-2 col-lg-1 control-label text-left">驱动程序</label>
                <div class="col-sm-4">
                  <select class="form-control" ng-model="formValues.LogDriverName" id="log-driver">
                    <option selected value="">默认日志记录驱动程序</option>
                    <option ng-repeat="driver in availableLoggingDrivers" ng-value="driver">{{ driver }}</option>
                    <option value="none">none</option>
                  </select>
                </div>
                <div class="col-sm-5">
                  <p class="small text-muted">
                    日志记录驱动程序将覆盖默认的Docker守护程序驱动程序。如果不想覆盖它，请选择默认日志记录驱动程序。支持的日志记录驱动程序
                    可在 <a href="https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers" target="_blank">Docker文档</a> 中找到。
                  </p>
                </div>
              </div>
              <!-- !logging-driver -->
              <!-- logging-opts -->
              <div class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">
                    选项
                    <portainer-tooltip
                      position="'top'"
                      message="'除非选择了除 none 或 默认 以外的驱动程序，否则添加按钮将被禁用。选项是针对所选驱动程序的，参考驱动程序文档。'"
                    ></portainer-tooltip>
                  </label>
                  <span
                    class="label label-default interactive"
                    style="margin-left: 10px"
                    ng-click="!formValues.LogDriverName || formValues.LogDriverName === 'none' || addLogDriverOpt(formValues.LogDriverName)"
                  >
                    <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 添加日志记录驱动程序选项
                  </span>
                </div>
                <!-- logging-opts-input-list -->
                <div class="col-sm-12 form-inline" style="margin-top: 10px">
                  <div ng-repeat="opt in formValues.LogDriverOpts" style="margin-top: 2px">
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">选项</span>
                      <input type="text" class="form-control" ng-model="opt.name" placeholder="例如 FOO" />
                    </div>
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">值</span>
                      <input type="text" class="form-control" ng-model="opt.value" placeholder="例如 bar" />
                    </div>
                    <button class="btn btn-light" type="button" ng-click="removeLogDriverOpt($index)">
                      <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                    </button>
                  </div>
                </div>
                <!-- logging-opts-input-list -->
              </div>
              <!-- !logging-opts -->
            </form>
          </div>
          <!-- !tab-command -->
          <!-- tab-volume -->
          <div class="tab-pane" id="volumes">
            <form class="form-horizontal" style="margin-top: 15px">
              <!-- volumes -->
              <div class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">存储卷映射</label>
                  <span class="label label-default interactive" style="margin-left: 10px" ng-click="addVolume()">
                    <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 添加额外存储卷
                  </span>
                </div>
                <!-- volumes-input-list -->
                <div class="form-inline" style="margin-top: 10px">
                  <div ng-repeat="volume in formValues.Volumes">
                    <!-- volume-line1 -->
                    <div class="col-sm-12 form-inline" style="margin-top: 10px">
                      <!-- container-path -->
                      <div class="input-group input-group-sm col-sm-6">
                        <span class="input-group-addon">容器</span>
                        <input type="text" class="form-control" ng-model="volume.containerPath" placeholder="例如 /path/in/container" />
                      </div>
                      <!-- !container-path -->
                      <!-- volume-type -->
                      <div class="input-group col-sm-5" style="margin-left: 5px">
                        <div class="btn-group btn-group-sm" ng-if="allowBindMounts">
                          <label class="btn btn-light" ng-model="volume.type" uib-btn-radio="'volume'" ng-click="volume.name = ''">存储卷</label>
                          <label class="btn btn-light" ng-model="volume.type" uib-btn-radio="'bind'" ng-click="volume.name = ''">绑定</label>
                        </div>
                        <button class="btn btn-light" type="button" ng-click="removeVolume($index)">
                          <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                        </button>
                      </div>
                      <!-- !volume-type -->
                    </div>
                    <!-- !volume-line1 -->
                    <!-- volume-line2 -->
                    <div class="col-sm-12 form-inline" style="margin-top: 5px">
                      <pr-icon icon="'arrow-right'"></pr-icon>
                      <!-- volume -->
                      <div class="input-group input-group-sm col-sm-6" ng-if="volume.type === 'volume'">
                        <span class="input-group-addon">存储卷</span>
                        <select class="form-control" ng-model="volume.name">
                          <option selected disabled hidden value="">选择一个存储卷</option>
                          <option ng-repeat="vol in availableVolumes" ng-value="vol.Name">{{ vol.Name | truncate : 30 }} - {{ vol.Driver | truncate : 30 }}</option>
                        </select>
                      </div>
                      <!-- !volume -->
                      <!-- bind -->
                      <div class="input-group input-group-sm col-sm-6" ng-if="volume.type === 'bind'">
                        <span class="input-group-addon">主机</span>
                        <input type="text" class="form-control" ng-model="volume.name" placeholder="例如 /path/on/host" />
                      </div>
                      <!-- !bind -->
                      <!-- read-only -->
                      <div class="input-group input-group-sm col-sm-5" style="margin-left: 5px">
                        <div class="btn-group btn-group-sm">
                          <label class="btn btn-light" ng-model="volume.readOnly" uib-btn-radio="false">可写</label>
                          <label class="btn btn-light" ng-model="volume.readOnly" uib-btn-radio="true">只读</label>
                        </div>
                      </div>
                      <!-- !read-only -->
                    </div>
                    <!-- !volume-line2 -->
                  </div>
                </div>
                <!-- !volumes-input-list -->
              </div>
            </form>
            <!-- !volumes -->
          </div>
          <!-- !tab-volume -->
          <!-- tab-network -->
          <div class="tab-pane" id="network">
            <form class="form-horizontal" style="margin-top: 15px">
              <div class="form-group" ng-if="globalNetworkCount === 0 && applicationState.endpoint.mode.provider !== 'DOCKER_SWARM_MODE'">
                <div class="col-sm-12">
                  <span class="small text-muted">您没有任何共享网络。请转到<a ui-sref="docker.networks">网络视图</a>创建一个。</span>
                </div>
              </div>
              <!-- network-input -->
              <div class="form-group">
                <label for="container_network" class="col-sm-2 col-lg-1 control-label text-left">网络</label>
                <div class="col-sm-9">
                  <select
                    class="form-control"
                    ng-options="net.Name as net.Name for net in availableNetworks"
                    ng-model="config.HostConfig.NetworkMode"
                    id="container_network"
                    ng-change="resetNetworkConfig()"
                  >
                    <option selected disabled hidden value="">选择一个网络</option>
                  </select>
                </div>
              </div>
              <!-- !network-input -->
              <!-- container-name-input -->
              <div class="form-group" ng-if="config.HostConfig.NetworkMode == 'container'">
                <label for="container_network_container" class="col-sm-2 col-lg-1 control-label text-left">容器</label>
                <div class="col-sm-9">
                  <select ng-options="container|containername for container in runningContainers" class="form-control" ng-model="formValues.NetworkContainer">
                    <option selected disabled hidden value="">选择一个容器</option>
                  </select>
                </div>
              </div>
              <!-- !container-name-input -->
              <!-- hostname-input -->
              <div class="form-group">
                <label for="container_hostname" class="col-sm-2 col-lg-1 control-label text-left">主机名</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="config.Hostname" id="container_hostname" placeholder="例如 web01" />
                </div>
              </div>
              <!-- !hostname-input -->
              <!-- domainname-input -->
              <div class="form-group">
                <label for="container_domainname" class="col-sm-2 col-lg-1 control-label text-left">域名</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="config.Domainname" id="container_domainname" placeholder="例如 example.com" />
                </div>
              </div>
              <!-- !domainname -->
              <!-- mac-address-input -->
              <div class="form-group">
                <label for="container_macaddress" class="col-sm-2 col-lg-1 control-label text-left">MAC地址</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="formValues.MacAddress" id="container_macaddress" placeholder="例如 12-34-56-78-9a-bc" />
                </div>
              </div>
              <!-- !mac-address-input -->
              <!-- ipv4-input -->
              <div class="form-group">
                <label for="container_ipv4" class="col-sm-2 col-lg-1 control-label text-left">IPv4地址</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="formValues.IPv4" id="container_ipv4" placeholder="例如 172.20.0.7" />
                </div>
              </div>
              <!-- !ipv4-input -->
              <!-- ipv6-input -->
              <div class="form-group">
                <label for="container_ipv6" class="col-sm-2 col-lg-1 control-label text-left">IPv6地址</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="formValues.IPv6" id="container_ipv6" placeholder="例如 a:b:c:d::1234" />
                </div>
              </div>
              <!-- !ipv6-input -->
              <!-- dns-primary-input -->
              <div class="form-group">
                <label for="container_dns_primary" class="col-sm-2 col-lg-1 control-label text-left">主DNS服务器</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="formValues.DnsPrimary" id="container_dns_primary" placeholder="例如 1.1.1.1, 2606:4700:4700::1111" />
                </div>
              </div>
              <!-- !dns-primary-input -->
              <!-- dns-secondary-input -->
              <div class="form-group">
                <label for="container_dns_secondary" class="col-sm-2 col-lg-1 control-label text-left">次DNS服务器</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" ng-model="formValues.DnsSecondary" id="container_dns_secondary" placeholder="例如 1.0.0.1, 2606:4700:4700::1001" />
                </div>
              </div>
              <!-- !dns-secondary-input -->
              <!-- extra-hosts-variables -->
              <div class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">Hosts文件条目</label>
                  <span class="label label-default interactive" style="margin-left: 10px" ng-click="addExtraHost()">
                    <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 添加额外条目
                  </span>
                </div>
                <!-- extra-hosts-input-list -->
                <div class="col-sm-12 form-inline" style="margin-top: 10px">
                  <div ng-repeat="variable in formValues.ExtraHosts" style="margin-top: 2px">
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">值</span>
                      <input type="text" class="form-control" ng-model="variable.value" placeholder="例如 主机:IP" />
                    </div>
                    <button class="btn btn-light" type="button" ng-click="removeExtraHost($index)">
                      <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                    </button>
                  </div>
                </div>
                <!-- !extra-hosts-input-list -->
              </div>
              <!-- !extra-hosts-variables -->
            </form>
          </div>
          <!-- !tab-network -->
          <!-- tab-labels -->
          <div class="tab-pane" id="labels">
            <form class="form-horizontal" style="margin-top: 15px">
              <!-- labels -->
              <div class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">标签</label>
                  <span class="label label-default interactive" style="margin-left: 10px" ng-click="addLabel()"> <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 添加标签 </span>
                </div>
                <!-- labels-input-list -->
                <div class="col-sm-12 form-inline" style="margin-top: 10px">
                  <div ng-repeat="label in formValues.Labels" style="margin-top: 2px">
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">名称</span>
                      <input type="text" class="form-control" ng-model="label.name" placeholder="例如 com.example.foo" />
                    </div>
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">值</span>
                      <input type="text" class="form-control" ng-model="label.value" placeholder="例如 bar" />
                    </div>
                    <button class="btn btn-sm btn-light" type="button" ng-click="removeLabel($index)">
                      <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                    </button>
                  </div>
                </div>
                <!-- !labels-input-list -->
              </div>
              <!-- !labels-->
            </form>
          </div>
          <!-- !tab-labels -->
          <!-- tab-env -->
          <div class="tab-pane" id="env">
            <div class="form-horizontal">
              <environment-variables-panel
                values="formValues.Env"
                explanation="'这些值将在容器部署时应用'"
                on-change="(handleEnvVarChange)"
              ></environment-variables-panel>
            </div>
          </div>
          <!-- !tab-env -->
          <!-- tab-restart-policy -->
          <div class="tab-pane" id="restart-policy">
            <form class="form-horizontal" style="margin-top: 15px">
              <div class="form-group">
                <div class="col-sm-12">
                  <label class="control-label text-left"> 重启策略 </label>
                  <div class="btn-group btn-group-sm" style="margin-left: 20px">
                    <label class="btn btn-light" ng-model="config.HostConfig.RestartPolicy.Name" uib-btn-radio="'no'"> 从不 </label>
                    <label class="btn btn-light" ng-model="config.HostConfig.RestartPolicy.Name" uib-btn-radio="'always'"> 始终 </label>
                    <label class="btn btn-light" ng-model="config.HostConfig.RestartPolicy.Name" uib-btn-radio="'on-failure'"> 出现故障时 </label>
                    <label class="btn btn-light" ng-model="config.HostConfig.RestartPolicy.Name" uib-btn-radio="'unless-stopped'"> 除非停止 </label>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <!-- !tab-restart-policy -->
          <!-- tab-runtime-resources -->
          <div class="tab-pane" id="runtime-resources">
            <form class="form-horizontal" style="margin-top: 15px">
              <div class="col-sm-12 form-section-title"> 运行时 </div>
              <!-- privileged-mode -->
              <div class="form-group" ng-if="isAdmin || allowPrivilegedMode">
                <div class="col-sm-12">
                  <por-switch-field
                    label-class="'col-sm-2'"
                    checked="config.HostConfig.Privileged"
                    label="'特权模式'"
                    on-change="(handlePrivilegedChange)"
                  ></por-switch-field>
                </div>
              </div>
              <!-- !privileged-mode -->
              <!-- init -->
              <div class="form-group" ng-if="applicationState.endpoint.apiVersion >= 1.37">
                <div class="col-sm-12">
                  <por-switch-field label-class="'col-sm-2'" checked="config.HostConfig.Init" label="'初始化'" on-change="(handleInitChange)"></por-switch-field>
                </div>
              </div>
              <!-- !init -->
              <!-- runtimes -->
              <div class="form-group">
                <label for="container_runtime" class="col-sm-1 control-label text-left">运行时</label>
                <div class="col-sm-11">
                  <select class="form-control" ng-model="config.HostConfig.Runtime" id="container_runtime" ng-options="runtime for runtime in availableRuntimes">
                    <option selected value="">默认</option>
                  </select>
                </div>
              </div>
              <!-- !runtimes -->
            </form>
            <form class="form-horizontal" style="margin-top: 15px" name="resourceForm">
              <!-- devices -->
              <div ng-if="showDeviceMapping" class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">设备</label>
                  <span class="label label-default interactive" style="margin-left: 10px" ng-click="addDevice()"> <pr-icon icon="'plus'" mode="'alt'"></pr-icon> 添加设备 </span>
                </div>
                <!-- devices-input-list -->
                <div class="col-sm-12 form-inline" style="margin-top: 10px">
                  <div ng-repeat="device in config.HostConfig.Devices" style="margin-top: 2px">
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">主机</span>
                      <input type="text" class="form-control" ng-model="device.pathOnHost" placeholder="例如 /dev/tty0" />
                    </div>
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">容器</span>
                      <input type="text" class="form-control" ng-model="device.pathInContainer" placeholder="例如 /dev/tty0" />
                    </div>
                    <button class="btn btn-sm btn-light" type="button" ng-click="removeDevice($index)">
                      <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                    </button>
                  </div>
                </div>
                <!-- !devices-input-list -->
              </div>
              <!-- !devices-->
              <!-- sysctls -->
              <div ng-if="showSysctls" class="form-group">
                <div class="col-sm-12" style="margin-top: 5px">
                  <label class="control-label text-left">内核参数</label>
                  <span class="label label-default interactive" style="margin-left: 10px" ng-click="addSysctl()"> <pr-icon icon="'plus'"></pr-icon> 添加内核参数 </span>
                </div>
                <!-- sysctls-input-list -->
                <div class="col-sm-12 form-inline" style="margin-top: 10px">
                  <div ng-repeat="sysctl in formValues.Sysctls" style="margin-top: 2px">
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">名称</span>
                      <input type="text" class="form-control" ng-model="sysctl.name" placeholder="例如 FOO" />
                    </div>
                    <div class="input-group col-sm-5 input-group-sm">
                      <span class="input-group-addon">值</span>
                      <input type="text" class="form-control" ng-model="sysctl.value" placeholder="例如 bar" />
                    </div>
                    <button class="btn btn-sm btn-light" type="button" ng-click="removeSysctl($index)">
                      <pr-icon icon="'trash-2'" class-name="'icon-secondary icon-md'"></pr-icon>
                    </button>
                  </div>
                </div>
                <!-- !sysctls-input-list -->
              </div>
              <!-- !sysctls -->
              <!-- shm-size-input -->
              <div class="form-group">
                <label for="shm-size" class="col-sm-2 control-label text-left">共享内存大小</label>
                <div class="col-sm-2">
                  <input type="number" min="1" class="form-control" ng-model="formValues.ShmSize" id="shm-size" />
                </div>
                <div class="col-sm-2">
                  <p class="small text-muted mt-2">/dev/shm的大小（<b>MB</b>）</p>
                </div>
              </div>
              <!-- !shm-size-input -->
              <!-- #region GPU -->
              <div ng-if="applicationState.endpoint.mode.provider === 'DOCKER_STANDALONE'">
                <div class="col-sm-12 form-section-title"> GPU </div>

                <gpu
                  ng-if="applicationState.endpoint.apiVersion >= 1.4"
                  values="formValues.GPU"
                  on-change="(onGpuChange)"
                  gpus="endpoint.Gpus"
                  used-gpus="gpuUseList"
                  used-all-gpus="gpuUseAll"
                  enable-gpu-management="endpoint.EnableGPUManagement"
                >
                </gpu>
              </div>

              <!-- #endregion GPU -->
              <div ng-class="{ 'edit-resources': state.mode == 'duplicate' }">
                <div class="col-sm-12 form-section-title">资源</div>
                <!-- memory-reservation-input -->
                <div class="form-group flex">
                  <label for="memory-reservation" class="col-sm-3 col-lg-2 control-label vertical-center text-left">内存预留量（MB）</label>
                  <div class="col-sm-6">
                    <slider
                      on-change="(handleResourceChange)"
                      model="formValues.MemoryReservation"
                      floor="0"
                      ceil="state.sliderMaxMemory"
                      step="256"
                      ng-if="state.sliderMaxMemory"
                    ></slider>
                  </div>
                  <div class="col-sm-2 vertical-center">
                    <input
                      name="memory_reservation"
                      type="number"
                      min="0"
                      max="{{ state.sliderMaxMemory }}"
                      class="form-control"
                      ng-model="formValues.MemoryReservation"
                      id="memory-reservation"
                      required
                    />
                  </div>
                </div>
                <div class="form-group" ng-show="resourceForm.memory_reservation.$invalid">
                  <div class="col-sm-3 col-lg-2"></div>
                  <div class="col-sm-8 small text-muted">
                    <div ng-messages="resourceForm.memory-reservation.$error">
                      <p class="vertical-center text-warning">
                        <pr-icon icon="'alert-triangle'" mode="'warning'"></pr-icon> 值必须介于0和{{ state.sliderMaxMemory }}之间。
                      </p>
                    </div>
                  </div>
                </div>
                <!-- !memory-reservation-input -->
                <!-- memory-limit-input -->
                <div class="form-group flex">
                  <label for="memory-limit" class="col-sm-3 col-lg-2 control-label vertical-center text-left">内存限制（MB）</label>
                  <div class="col-sm-6">
                    <slider
                      on-change="(handleResourceChange)"
                      model="formValues.MemoryLimit"
                      floor="0"
                      ceil="state.sliderMaxMemory"
                      step="256"
                      ng-if="state.sliderMaxMemory"
                    ></slider>
                  </div>
                  <div class="col-sm-2 vertical-center">
                    <input
                      name="memory_Limit"
                      type="number"
                      min="0"
                      max="{{ state.sliderMaxMemory }}"
                      class="form-control"
                      ng-model="formValues.MemoryLimit"
                      id="memory-limit"
                      required
                    />
                  </div>
                </div>
                <div class="form-group" ng-show="resourceForm.memory_Limit.$invalid">
                  <div class="col-sm-3 col-lg-2"></div>
                  <div class="col-sm-8 small text-muted">
                    <div ng-messages="resourceForm.memory-limit.$error">
                      <p class="vertical-center text-warning">
                        <pr-icon icon="'alert-triangle'" mode="'warning'"></pr-icon> 值必须介于 0 和 {{ state.sliderMaxMemory }} 之间。
                      </p>
                    </div>
                  </div>
                </div>
                <!-- !memory-limit-input -->
                <!-- cpu-limit-input -->
                <div class="form-group flex">
                  <label for="cpu-limit" class="col-sm-3 col-lg-2 control-label vertical-center text-left">最大 CPU 使用率</label>
                  <div class="col-sm-8">
                    <slider
                      on-change="(handleResourceChange)"
                      model="formValues.CpuLimit"
                      floor="0"
                      ceil="state.sliderMaxCpu"
                      step="0.1"
                      precision="2"
                      ng-if="state.sliderMaxCpu"
                    ></slider>
                  </div>
                </div>
                <!-- !cpu-limit-input -->

                <!-- update-limit-btn -->
                <div class="form-group" ng-if="state.mode == 'duplicate'">
                  <div class="col-sm-12">
                    <button
                      type="button"
                      class="btn btn-primary btn-sm"
                      ng-disabled="state.actionInProgress || !formValues.RegistryModel.Image || (!formValues.RegistryModel.Registry && fromContainer)"
                      ng-click="update()"
                      button-spinner="state.actionInProgress"
                    >
                    <span ng-hide="state.actionInProgress">更新限制</span>
                    <span ng-show="state.actionInProgress">更新进行中...</span>
                    </button>
                  </div>
                  <div class="col-sm-12" ng-if="state.settingUnlimitedResources">
                    <p class="text-muted mr-4">
                      <pr-icon icon="'alert-triangle'" mode="'warning'" class-name="'mt-10'"></pr-icon>
                      将任何资源值更新为“无限制”将重新部署此容器。
                    </p>
                  </div>
                </div>
                <!-- !update-limit-btn -->
              </div>
            </form>
          </div>
          <!-- !tab-runtime-resources -->
          <!-- tab-container-capabilities -->
          <div class="tab-pane" id="container-capabilities">
            <container-capabilities capabilities="formValues.capabilities"></container-capabilities>
          </div>
          <!-- !tab-container-capabilities -->
        </div>
      </rd-widget-body>
    </rd-widget>
  </div>
</div>
